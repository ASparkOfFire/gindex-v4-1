os: linux
branches:
  only:
    - master
    - dev
language: node_js
node_js:
  - 14

git:
  depth: 3
  quiet: true
  submodules: false

cache:
  directories:
    - vuejs/.yarn/cache
    - vuejs/node_modules

install: bash ./scripts/install.sh

script:
  - if [ ${TRAVIS_BRANCH} == "master" && ${TRAVIS_PULL_REQUEST} == "false" ]; then bash ./scripts/prod-build.sh
  - if [ ${TRAVIS_BRANCH} == "dev" && ${TRAVIS_PULL_REQUEST} == "false" ]; then bash ./scripts/dev-build.sh;

deploy:
  - provider: script
    skip_cleanup: true
    script:
      - bash ./scripts/prod-deploy.sh
      - bash ./scripts/prod-after-deploy.sh
      - bash ./scripts/prod-release.sh
    on:
      branch: master

  - provider: script
    skip_cleanup: true
    script:
      - bash ./scripts/dev-deploy.sh
      - bash ./scripts/dev-after-deploy.sh
      - bash ./scripts/dev-release.sh
    on:
      branch: dev
